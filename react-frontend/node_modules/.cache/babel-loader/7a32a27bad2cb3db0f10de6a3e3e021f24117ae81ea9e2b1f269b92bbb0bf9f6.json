{"ast":null,"code":"import axios from 'axios';\nimport { jwtDecode } from 'jwt-decode';\nexport async function standardFetch(input) {\n  const {\n    url,\n    method = 'GET',\n    body,\n    contentType,\n    controller\n  } = input;\n  const headers = {\n    'Content-Type': contentType\n  };\n  const token = localStorage.getItem('token');\n  if (token) {\n    headers.Authorization = `Bearer ${token}`;\n  } else {\n    console.warn('No token found, user may not be authenticated');\n  }\n  const config = {\n    url,\n    method,\n    headers,\n    data: body,\n    signal: controller === null || controller === void 0 ? void 0 : controller.signal\n  };\n  try {\n    const response = await axios(config);\n    return response.data;\n  } catch (error) {\n    if (error.response) {\n      console.error('Axios error response:', error.response);\n      throw error.response.data;\n    } else {\n      console.error('Axios error:', error.message);\n      throw new Error('An unexpected error occurred.');\n    }\n  }\n}\nexport const fetchUser = async userId => {\n  return standardFetch({\n    url: `${process.env.API_URL}/User/getByUsername/${userId}`,\n    contentType: 'application/json'\n  });\n};\nexport const isUserLoggedIn = () => {\n  try {\n    let token = localStorage.getItem('token');\n    if (!token) {\n      return false;\n    }\n    const decodedToken = jwtDecode(token);\n    const currentTime = Math.floor(Date.now() / 1000);\n    if (decodedToken.exp < currentTime) {\n      return false;\n    }\n    return true;\n  } catch (e) {\n    console.error('Error decoding token:', e);\n    return false;\n  }\n};","map":{"version":3,"names":["axios","jwtDecode","standardFetch","input","url","method","body","contentType","controller","headers","token","localStorage","getItem","Authorization","console","warn","config","data","signal","response","error","message","Error","fetchUser","userId","process","env","API_URL","isUserLoggedIn","decodedToken","currentTime","Math","floor","Date","now","exp","e"],"sources":["C:/Users/umerb/OneDrive/Desktop/testApp/react-frontend/src/utils/fetches.tsx"],"sourcesContent":["import axios, { AxiosRequestConfig } from 'axios';\r\nimport { jwtDecode } from 'jwt-decode';\r\n\r\ninterface StandardFetchInput {\r\n  url: string;\r\n  method?: 'GET' | 'POST' | 'PUT' | 'DELETE';\r\n  body?: any;\r\n  contentType: string;\r\n  controller?: AbortController | null;\r\n}\r\n\r\n\r\ninterface CommonProfileProps {\r\n  userId: number;\r\n  username: string;\r\n  passwordHash: string;\r\n  phoneNumber: string;\r\n  email: string;\r\n  deviceIdentifier: string;\r\n  lastKnownIP: string;\r\n  userAgent: string;\r\n  operatingSystem: string;\r\n  browserName: string;\r\n  trustedDevice: boolean;\r\n  lastLoginDate: Date;\r\n}\r\n\r\n\r\nexport async function standardFetch<T>(input: StandardFetchInput): Promise<T> {\r\n  const { url, method = 'GET', body, contentType, controller } = input;\r\n\r\n  const headers: Record<string, string> = {\r\n    'Content-Type': contentType,\r\n  };\r\n\r\n  const token = localStorage.getItem('token');\r\n  if (token) {\r\n    headers.Authorization = `Bearer ${token}`;\r\n  } else {\r\n    console.warn('No token found, user may not be authenticated');\r\n  }\r\n\r\n  const config: AxiosRequestConfig = {\r\n    url,\r\n    method,\r\n    headers,\r\n    data: body,\r\n    signal: controller?.signal,\r\n  };\r\n\r\n  try {\r\n    const response = await axios(config);\r\n    return response.data as T;\r\n  } catch (error: any) {\r\n    if (error.response) {\r\n      console.error('Axios error response:', error.response);\r\n      throw error.response.data; \r\n    } else {\r\n      console.error('Axios error:', error.message);\r\n      throw new Error('An unexpected error occurred.');\r\n    }\r\n  }\r\n}\r\n\r\n\r\ntype User = CommonProfileProps;\r\nexport const fetchUser = async (userId: string): Promise<User> => {\r\n  return standardFetch<User>({\r\n    url: `${process.env.API_URL}/User/getByUsername/${userId}`,\r\n    contentType: 'application/json',\r\n  });\r\n};\r\n\r\nexport const isUserLoggedIn = () => {\r\n    try {\r\n        let token = localStorage.getItem('token');\r\n\r\n        if (!token) {\r\n         \r\n            return false;\r\n        }\r\n\r\n     \r\n        const decodedToken = jwtDecode<{ exp: number }>(token); \r\n        \r\n    \r\n        const currentTime = Math.floor(Date.now() / 1000);\r\n        if (decodedToken.exp < currentTime) {\r\n          \r\n            return false;\r\n        }\r\n\r\n        return true; \r\n    } catch (e) {\r\n        console.error('Error decoding token:', e);\r\n        return false;\r\n    }\r\n};\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAA8B,OAAO;AACjD,SAASC,SAAS,QAAQ,YAAY;AA2BtC,OAAO,eAAeC,aAAaA,CAAIC,KAAyB,EAAc;EAC5E,MAAM;IAAEC,GAAG;IAAEC,MAAM,GAAG,KAAK;IAAEC,IAAI;IAAEC,WAAW;IAAEC;EAAW,CAAC,GAAGL,KAAK;EAEpE,MAAMM,OAA+B,GAAG;IACtC,cAAc,EAAEF;EAClB,CAAC;EAED,MAAMG,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,EAAE;IACTD,OAAO,CAACI,aAAa,GAAG,UAAUH,KAAK,EAAE;EAC3C,CAAC,MAAM;IACLI,OAAO,CAACC,IAAI,CAAC,+CAA+C,CAAC;EAC/D;EAEA,MAAMC,MAA0B,GAAG;IACjCZ,GAAG;IACHC,MAAM;IACNI,OAAO;IACPQ,IAAI,EAAEX,IAAI;IACVY,MAAM,EAAEV,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAEU;EACtB,CAAC;EAED,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMnB,KAAK,CAACgB,MAAM,CAAC;IACpC,OAAOG,QAAQ,CAACF,IAAI;EACtB,CAAC,CAAC,OAAOG,KAAU,EAAE;IACnB,IAAIA,KAAK,CAACD,QAAQ,EAAE;MAClBL,OAAO,CAACM,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAACD,QAAQ,CAAC;MACtD,MAAMC,KAAK,CAACD,QAAQ,CAACF,IAAI;IAC3B,CAAC,MAAM;MACLH,OAAO,CAACM,KAAK,CAAC,cAAc,EAAEA,KAAK,CAACC,OAAO,CAAC;MAC5C,MAAM,IAAIC,KAAK,CAAC,+BAA+B,CAAC;IAClD;EACF;AACF;AAIA,OAAO,MAAMC,SAAS,GAAG,MAAOC,MAAc,IAAoB;EAChE,OAAOtB,aAAa,CAAO;IACzBE,GAAG,EAAE,GAAGqB,OAAO,CAACC,GAAG,CAACC,OAAO,uBAAuBH,MAAM,EAAE;IAC1DjB,WAAW,EAAE;EACf,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMqB,cAAc,GAAGA,CAAA,KAAM;EAChC,IAAI;IACA,IAAIlB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAEzC,IAAI,CAACF,KAAK,EAAE;MAER,OAAO,KAAK;IAChB;IAGA,MAAMmB,YAAY,GAAG5B,SAAS,CAAkBS,KAAK,CAAC;IAGtD,MAAMoB,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;IACjD,IAAIL,YAAY,CAACM,GAAG,GAAGL,WAAW,EAAE;MAEhC,OAAO,KAAK;IAChB;IAEA,OAAO,IAAI;EACf,CAAC,CAAC,OAAOM,CAAC,EAAE;IACRtB,OAAO,CAACM,KAAK,CAAC,uBAAuB,EAAEgB,CAAC,CAAC;IACzC,OAAO,KAAK;EAChB;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}